# Тесты

Комплексный набор тестов для банковской системы с проверкой всех уровней приложения.

## Структура тестов:

### 1. Репозитории (@DataJpaTest)
- **UserRepositoryTest** - тестирование работы с базой данных пользователей
- Проверка всех кастомных запросов и CRUD операций
- Тестирование связей между сущностями

### 2. Сервисы (@ExtendWith(MockitoExtension.class))
- **UserServiceTest** - тестирование бизнес-логики управления пользователями
- Мокирование зависимостей для изоляции тестирования
- Проверка обработки исключений и валидации

### 3. Контроллеры
#### Unit тесты (@WebMvcTest)
- **UserControllerTest** - тестирование REST API пользователей
- **AuthControllerTest** - тестирование аутентификации и авторизации
- Мокирование сервисов для изоляции тестирования контроллеров

#### Интеграционные тесты (@SpringBootTest)
- **UserManagementIntegrationTest** - полные интеграционные тесты
- Тестирование взаимодействия между всеми слоями приложения
- Проверка безопасности в реальной среде

### 4. Обработка исключений (@WebMvcTest)
- **GlobalExceptionHandlerTest** - тестирование глобального обработчика ошибок
- Проверка корректного форматирования ответов с ошибками
- Тестирование всех типов исключений

## Покрываемые сценарии:

### ✅ Функциональность
- CRUD операции для пользователей
- Аутентификация и авторизация
- Ролевая модель доступа
- Валидация данных
- Обработка ошибок

### ✅ Безопасность
- Проверка JWT токенов
- Ролевая авторизация (ADMIN/USER)
- Защита от несанкционированного доступа
- Безопасность паролей

### ✅ Качество кода
- Тестирование исключительных ситуаций
- Проверка граничных условий
- Валидация бизнес-правил
- Мокирование внешних зависимостей

## Запуск тестов:
```bash
# Все тесты
mvn test

# Тесты конкретного класса
mvn test -Dtest=UserRepositoryTest

# Тесты по паттерну
mvn test -Dtest="*Controller*"

# С отчетом покрытия
mvn test jacoco:report
```
