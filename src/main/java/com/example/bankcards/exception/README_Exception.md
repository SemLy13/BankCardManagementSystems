# Обработка исключений

Глобальный обработчик ошибок и пользовательские исключения для единого формата ответов API.

## Компоненты:

### 1. GlobalExceptionHandler (@ControllerAdvice)
Глобальный обработчик исключений, который перехватывает и форматирует все ошибки в единый формат ответа.

**Обрабатываемые исключения:**
- `IllegalArgumentException` - бизнес-логика ошибки (VALIDATION_ERROR)
- `MethodArgumentNotValidException` - ошибки валидации полей (@Valid)
- `ConstraintViolationException` - нарушения ограничений валидации
- `BadCredentialsException` - ошибки аутентификации
- `AccessDeniedException` - ошибки авторизации (доступ запрещен)
- `ResourceNotFoundException` - ресурс не найден (404)
- `BusinessException` - пользовательские бизнес-исключения
- `RuntimeException` - неожиданные ошибки времени выполнения
- `Exception` - все остальные исключения

**Формат ответа с ошибкой:**
```json
{
  "success": false,
  "error": {
    "code": "ERROR_CODE",
    "message": "Описание ошибки",
    "details": "Дополнительная информация",
    "timestamp": "2025-10-01 12:00:00",
    "path": "/api/users/123",
    "validationErrors": {
      "field1": "Сообщение об ошибке поля 1",
      "field2": "Сообщение об ошибке поля 2"
    }
  }
}
```

### 2. Пользовательские исключения:

#### ResourceNotFoundException
Для случаев, когда запрашиваемый ресурс не найден (404 ошибки).

#### BusinessException
Гибкое бизнес-исключение с кодом ошибки и HTTP статусом:
- Конструкторы для различных сценариев использования
- Поддержка пользовательских кодов ошибок
- Настраиваемый HTTP статус ответа

## Преимущества:
- Единый формат всех ошибок в API
- Подробная информация об ошибках валидации
- Правильные HTTP статус-коды
- Логирование всех ошибок
- Поддержка интернационализации кодов ошибок
